@startuml

' --- CẤU HÌNH GIAO DIỆN ---
skinparam linetype ortho
skinparam classAttributeIconSize 0
skinparam handwritten false
skinparam monochrome false

' --- LỚP CONTROLLER ---
package "Controller Layer" {
    class BookingController <<Controller>> {
        - requestDate : Date
        - currentUserIP : String
        - sessionToken : String
        + makeReservation(bookingInfo : BookingDTO, clientLang : String) : boolean
        + cancelReservation(bookingId : int, reason : String) : boolean
        + getBookingDetails(bookingId : int) : BookingDTO
    }
}

' --- LỚP SERVICE ---
package "Service Layer" {
    interface IBookingService <<Interface>> {
        + checkAvailability(roomId : int, checkIn : Date, checkOut : Date) : boolean
        + calculateTotal(bookingId : int, currency : String) : double
        + applyDiscount(bookingId : int, code : String) : void
    }

    class BookingService <<Service>> {
        - serviceConfig : Config
        - discountRate : float
        - logger : Logger
        + checkAvailability(roomId : int, checkIn : Date, checkOut : Date) : boolean
        + calculateTotal(bookingId : int, currency : String) : double
        + applyDiscount(bookingId : int, code : String) : void
    }
}

' --- LỚP REPOSITORY ---
package "Data Access Layer" {
    interface IBookingRepository <<Repository>> {
        - dbConnection : Connection
        - tableName : String
        - timeout : int
        + save(booking : Booking) : boolean
        + findById(id : int) : Booking
        + delete(id : int, softDelete : boolean) : void
    }
}

' --- THỰC THỂ (ENTITIES) ---
package "Entities" {
    class Hotel <<Entity>> {
        - hotelId : int
        - name : String
        - address : String
        + getHotelInfo(language : String) : String
        + updateInfo(newName : String, newAddress : String) : void
        + checkOperatingStatus(queryDate : Date) : boolean
    }

    class Room <<Entity>> {
        - roomId : int
        - roomNumber : String
        - floor : int
        + cleanRoom(staffId : int, notes : String) : void
        + maintenance(reason : String, durationHours : int) : void
        + getStatus(onDate : Date) : String
    }

    class RoomType <<Entity>> {
        - typeId : int
        - typeName : String
        - basePrice : double
        + updatePrice(newPrice : double, effectiveDate : Date) : void
        + getDescription(languageCode : String) : String
        + checkFeatures() : List<String>
    }

    class Guest <<Entity>> {
        - guestId : int
        - fullName : String
        - phoneNumber : String
        + register(email : String, pass : String, name : String) : boolean
        + login(email : String, passHash : String) : boolean
        + updateProfile(email : String, phone : String, addr : String) : void
    }

    class Booking <<Entity>> {
        - bookingId : int
        - checkInDate : Date
        - checkOutDate : Date
        + confirmBooking(paymentMethod : String, transactionId : String) : void
        + cancelBooking(reason : String, refundRequested : boolean) : void
        + getDuration() : int
    }
}

' --- ĐỊNH NGHĨA QUAN HỆ (RELATIONSHIPS) ---

' 1. Realization
IBookingService <|.. BookingService

' 2. Dependency
BookingController ..> IBookingService
BookingService ..> IBookingRepository

' 3. Composition
Hotel "1" *-- "0..*" Room

' 4. Aggregation
Booking "0..*" o-- "1..*" Room

' 5. Association
Guest "1" --> "0..*" Booking
Room "0..*" --> "1" RoomType

@enduml